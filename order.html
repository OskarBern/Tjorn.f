<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Your Order - TJÖRN FINESSE</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #A00000; /* Dark Red */
            --secondary-color: #2e2e2e; /* Dark Grey/Black */
            --text-color: #ffffff;
            --background-color: #1a1a1a;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 40px 15px;
        }

        .order-card {
            background-color: var(--secondary-color);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 500px;
        }

        .order-card h1 {
            font-family: 'Oswald', sans-serif;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 25px;
            font-size: 2rem;
        }

        .summary p {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding-bottom: 5px;
            border-bottom: 1px dashed #444;
        }

        .summary strong {
            font-size: 1.1em;
            color: #fff;
        }

        .payment-section, .address-section {
            padding: 20px 0;
        }

        /* Swish Styling */
        .swish-box {
            background-color: #383838;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
        }

        .swish-box img {
            max-width: 180px;
            height: auto;
            border-radius: 4px;
            margin-bottom: 15px;
            border: 2px solid var(--primary-color);
        }

        .swish-box a {
            color: #4CAF50; /* Swish green color for link */
            text-decoration: none;
            font-weight: 600;
            display: block;
            margin-top: 10px;
        }
        
        .swish-box p {
            font-size: 0.9em;
            color: #ccc;
        }

        /* Form Styling */
        .address-form input, .address-form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            border: 1px solid #555;
            background-color: #444;
            color: var(--text-color);
            box-sizing: border-box;
        }
        
        .address-form label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #ccc;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            border-radius: 4px;
            text-decoration: none;
            text-transform: uppercase;
            font-weight: 700;
            cursor: pointer;
            border: none;
            margin-top: 15px;
        }
        
        .btn.primary {
            background-color: var(--primary-color);
            color: var(--text-color);
        }
        .btn.primary:hover {
            background-color: #b71c1c; 
        }
        .btn.success {
            background-color: #4CAF50;
            color: white;
        }
        .btn.success:hover {
            background-color: #3e8e41;
        }

        .hidden {
            display: none;
        }

        .message-box {
            background-color: #666;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }
        .total-row {
            border-top: 2px solid var(--primary-color) !important;
            padding-top: 10px !important;
            margin-top: 10px !important;
        }
    </style>
</head>
<body>

    <div class="order-card">
        <h1>Complete Your Purchase</h1>
        
        <!-- Order Summary -->
        <div class="summary">
            <h2 style="font-size: 1.3rem; margin-top: 0; color: white;">Order Details</h2>
            <p>
                <span>Product:</span>
                <span id="product-name">Loading...</span>
            </p>
            <p>
                <span>Item Price:</span>
                <span id="item-price">0.00 SEK</span>
            </p>
            <p>
                <span>Shipping Fee:</span>
                <span id="shipping-fee">4.00 SEK</span>
            </p>
            <p class="total-row">
                <strong>Total Amount Due:</strong>
                <strong id="total-amount">0.00 SEK</strong>
            </p>
        </div>

        <!-- Payment Instructions Section -->
        <div class="payment-section">
            <h2 style="font-size: 1.3rem; margin-top: 20px; color: white;">Step 1: Swish Payment</h2>
            <p style="color: #ccc;">Please complete the payment for your order total to the Swish number below. Once done, click 'I Have Paid' to submit your address.</p>
            
            <div class="swish-box">
                <p>Scan this QR code to pay <strong><span id="qr-total-amount">0.00</span> SEK</strong></p>
                
                <!-- Your Swish QR Code -->
                <img src="Screenshot 2025-11-30 at 21.14.25.png" alt="Swish QR Code" onerror="this.onerror=null; this.src='https://placehold.co/180x180/A00000/ffffff?text=QR%20Placeholder'">
                
                <p>OR Swish to our number:</p>
                <strong style="color: #4CAF50; font-size: 1.5rem;">123-456 78 90</strong> <!-- ⚠️ REPLACE THIS WITH YOUR ACTUAL SWISH NUMBER ⚠️ -->
                
                <a id="swish-link" href="#" target="_blank" class="btn success">
                    Click to Pay via Swish App
                </a>
            </div>

            <button id="confirm-payment-btn" class="btn primary" style="margin-top: 25px;">
                I Have Paid & Ready to Enter Address
            </button>
        </div>

        <!-- Address Submission Section (Hidden until payment confirmed) -->
        <div id="address-section" class="address-section hidden">
            <h2 style="font-size: 1.3rem; margin-top: 0; color: white;">Step 2: Shipping Address</h2>
            <form id="address-form" class="address-form">
                <p style="color: #ccc; font-size: 0.9em;">Please enter the name and number associated with your Swish payment, and your full shipping address.</p>

                <label for="name">Name (as used in Swish):</label>
                <input type="text" id="name" name="name" required>

                <label for="phone">Swish Phone Number:</label>
                <input type="tel" id="phone" name="phone" required>
                
                <label for="address">Full Shipping Address:</label>
                <textarea id="address" name="address" rows="3" placeholder="Street Address, Postal Code, City, Country" required></textarea>
                
                <label for="notes">Order Notes (Optional):</label>
                <textarea id="notes" name="notes" rows="2" placeholder="e.g., specific color, delivery instructions"></textarea>

                <button type="submit" class="btn primary">Submit Address & Complete Order</button>
            </form>
            <div id="confirmation-message" class="message-box hidden">
                <h3>Order Submitted!</h3>
                <p>Thank you for your purchase. We have received your address and will ship your order shortly after confirming your Swish payment. You will receive a confirmation email soon!</p>
            </div>
        </div>
        
        <a href="index.html" style="display: block; text-align: center; margin-top: 20px; color: #ccc;">Return to Home Page</a>
    </div>

    <script>
        // ⚠️ REPLACE THIS WITH YOUR ACTUAL 10-DIGIT SWISH NUMBER HERE (no dashes/spaces)
        const SWISH_NUMBER = "1234567890"; 
        const SHIPPING_FEE = 4.00;

        function initializeOrder() {
            const urlParams = new URLSearchParams(window.location.search);
            // Default product name if URL parameter is missing
            const productName = urlParams.get('product') || 'Selected Item';
            let price = parseFloat(urlParams.get('price'));
            
            if (isNaN(price)) {
                price = 0.00;
                console.error("Price parameter missing or invalid. Defaulting to 0.00 SEK.");
            }

            const total = price + SHIPPING_FEE;
            const totalFixed = total.toFixed(2);
            const priceFixed = price.toFixed(2);

            // Display details
            document.getElementById('product-name').textContent = productName;
            document.getElementById('item-price').textContent = `${priceFixed} SEK`;
            document.getElementById('shipping-fee').textContent = `${SHIPPING_FEE.toFixed(2)} SEK`;
            document.getElementById('total-amount').textContent = `${totalFixed} SEK`;
            document.getElementById('qr-total-amount').textContent = totalFixed;

            // Generate Swish link (msvi:// is the mobile deep link protocol for Swish)
            const swishLink = `swish://payment?amount=${totalFixed}&recipient=${SWISH_NUMBER}&message=TJORN%20Order%20${productName.replace(/ /g, '%20')}`;
            document.getElementById('swish-link').href = swishLink;
        }

        // Event Listeners
        document.getElementById('confirm-payment-btn').addEventListener('click', () => {
            // Show address form and hide confirmation button
            document.getElementById('address-section').classList.remove('hidden');
            document.getElementById('confirm-payment-btn').classList.add('hidden');
        });

        document.getElementById('address-form').addEventListener('submit', function(event) {
            event.preventDefault();

            // Gather data
            const orderData = {
                product: document.getElementById('product-name').textContent,
                totalAmount: document.getElementById('total-amount').textContent,
                swishName: document.getElementById('name').value,
                swishPhone: document.getElementById('phone').value,
                shippingAddress: document.getElementById('address').value,
                notes: document.getElementById('notes').value,
                timestamp: new Date().toISOString()
            };

            // NOTE: In a real e-commerce scenario, you would use 'fetch' here to send
            // 'orderData' to your secure backend server for processing and matching
            // against the Swish payment reference.
            
            console.log("Order Data Collected:", orderData);
            
            // Display confirmation message and hide form
            document.getElementById('address-form').classList.add('hidden');
            document.getElementById('confirmation-message').classList.remove('hidden');
        });

        // Initialize on load
        initializeOrder();
    </script>
</body>
</html>